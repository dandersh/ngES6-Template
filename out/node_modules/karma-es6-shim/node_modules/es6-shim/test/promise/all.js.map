{"version":3,"sources":["../../../../../../../node_modules/karma-es6-shim/node_modules/es6-shim/test/promise/all.js"],"names":[],"mappings":"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","file":"all.js","sourcesContent":["/* global it, describe, expect, assert, Promise */\n\nvar failIfThrows = function (done) {\n  'use strict';\n\n  return function (e) {\n    done(e || new Error());\n  };\n};\n\ndescribe('Promise.all', function () {\n  'use strict';\n\n  it('should not be enumerable', function () {\n    expect(Promise).ownPropertyDescriptor('all').to.have.property('enumerable', false);\n  });\n\n  it('fulfills if passed an empty array', function (done) {\n    var iterable = [];\n\n    Promise.all(iterable).then(function (value) {\n      assert(Array.isArray(value));\n      assert.deepEqual(value, []);\n    }).then(done, failIfThrows(done));\n  });\n\n  it('fulfills if passed an empty array-like', function (done) {\n    var f = function () {\n      Promise.all(arguments).then(function (value) {\n        assert(Array.isArray(value));\n        assert.deepEqual(value, []);\n      }).then(done, failIfThrows(done));\n    };\n    f();\n  });\n\n  it('fulfills if passed an array of mixed fulfilled promises and values', function (done) {\n    var iterable = [0, Promise.resolve(1), 2, Promise.resolve(3)];\n\n    Promise.all(iterable).then(function (value) {\n      assert(Array.isArray(value));\n      assert.deepEqual(value, [0, 1, 2, 3]);\n    }).then(done, failIfThrows(done));\n  });\n\n  it('rejects if any passed promise is rejected', function (done) {\n    var foreverPending = new Promise(function () { });\n    var error = new Error('Rejected');\n    var rejected = Promise.reject(error);\n\n    var iterable = [foreverPending, rejected];\n\n    Promise.all(iterable).then(\n      function () {\n        assert(false, 'should never get here');\n      },\n      function (reason) {\n        assert.strictEqual(reason, error);\n      }\n    ).then(done, failIfThrows(done));\n  });\n\n  it('resolves foreign thenables', function (done) {\n    var normal = Promise.resolve(1);\n    var foreign = { then: function (f) { f(2); } };\n\n    var iterable = [normal, foreign];\n\n    Promise.all(iterable).then(function (value) {\n      assert.deepEqual(value, [1, 2]);\n    }).then(done, failIfThrows(done));\n  });\n\n  it('fulfills when passed an sparse array, giving `undefined` for the omitted values', function (done) {\n    /* jshint elision: true */\n    /* jscs:disable disallowSpaceBeforeComma */\n    /* jscs:disable requireSpaceAfterComma */\n    /* eslint-disable no-sparse-arrays */\n    var iterable = [Promise.resolve(0), , , Promise.resolve(1)];\n    /* eslint-enable no-sparse-arrays */\n    /* jscs:enable requireSpaceAfterComma */\n    /* jscs:enable disallowSpaceBeforeComma */\n    /* jshint elision: false */\n\n    Promise.all(iterable).then(function (value) {\n      assert.deepEqual(value, [0, undefined, undefined, 1]);\n    }).then(done, failIfThrows(done));\n  });\n\n  it('does not modify the input array', function (done) {\n    var input = [0, 1];\n    var iterable = input;\n\n    Promise.all(iterable).then(function (value) {\n      assert.notStrictEqual(input, value);\n    }).then(done, failIfThrows(done));\n  });\n\n  it('should reject with a TypeError if given a non-iterable', function (done) {\n    var notIterable = {};\n\n    Promise.all(notIterable).then(\n      function () {\n        assert(false, 'should never get here');\n      },\n      function (reason) {\n        assert(reason instanceof TypeError);\n      }\n    ).then(done, failIfThrows(done));\n  });\n\n  // test cases from\n  // https://github.com/domenic/promises-unwrapping/issues/89#issuecomment-33110203\n  var tamper = function (p) {\n    p.then = function (fulfill, reject) {\n      fulfill('tampered');\n      return Promise.prototype.then.call(this, fulfill, reject);\n    };\n    return p;\n  };\n\n  it('should be robust against tampering (1)', function (done) {\n    var g = [tamper(Promise.resolve(0))];\n    // Prevent countdownHolder.[[Countdown]] from ever reaching zero\n    Promise.all(g).then(\n      function () { done(); },\n      failIfThrows(done)\n    );\n  });\n\n  it('should be robust against tampering (2)', function (done) {\n    // Promise from Promise.all resolved before arguments\n    var fulfillCalled = false;\n\n    var g = [\n      Promise.resolve(0),\n      tamper(Promise.resolve(1)),\n      Promise.resolve(2).then(function () {\n        assert(!fulfillCalled, 'should be resolved before all()');\n      }).then(function () {\n        assert(!fulfillCalled, 'should be resolved before all()');\n      })['catch'](failIfThrows(done))\n    ];\n    Promise.all(g).then(function () {\n      assert(!fulfillCalled, 'should be resolved last');\n      fulfillCalled = true;\n    }).then(done, failIfThrows(done));\n  });\n\n  it('should be robust against tampering (3)', function (done) {\n    var g = [\n      Promise.resolve(0),\n      tamper(Promise.resolve(1)),\n      Promise.reject(2)\n    ];\n    // Promise from Promise.all resolved despite rejected promise in arguments\n    Promise.all(g).then(function () {\n      throw new Error('should not reach here!');\n    }, function (e) {\n      assert.strictEqual(e, 2);\n    }).then(done, failIfThrows(done));\n  });\n\n  it('should be robust against tampering (4)', function (done) {\n    var hijack = true;\n    var actualArguments = [];\n    var P = function (resolver) {\n      var self;\n      if (hijack) {\n        hijack = false;\n        self = new Promise(function (resolve, reject) {\n          return resolver(function (values) {\n            // record arguments & # of times resolve function is called\n            actualArguments.push(values.slice());\n            return resolve(values);\n          }, reject);\n        });\n      } else {\n        self = new Promise(resolver);\n      }\n      Object.setPrototypeOf(self, P.prototype);\n      return self;\n    };\n    if (!Object.setPrototypeOf) { return done(); } // skip test if on IE < 11\n    Object.setPrototypeOf(P, Promise);\n    P.prototype = Object.create(Promise.prototype, {\n      constructor: { value: P }\n    });\n    P.resolve = function (p) { return p; };\n\n    var g = [\n      Promise.resolve(0),\n      tamper(Promise.resolve(1)),\n      Promise.resolve(2)\n    ];\n\n    // Promise.all calls resolver twice\n    P.all(g)['catch'](failIfThrows(done));\n    Promise.resolve().then(function () {\n      assert.deepEqual(actualArguments, [[0, 'tampered', 2]]);\n    }).then(done, failIfThrows(done));\n  });\n});\n"]}